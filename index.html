<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Multi Oyun Saytı</title>
<style>
:root {
  --bg: #f2f2f2;
  --btn-bg: #333;
  --btn-color: #fff;
  --btn-radius: 8px;
}
html, body {
  height: 100%;
  margin: 0;
}
body {
  background: var(--bg);
  font-family: Inter, Arial, sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
}
#menu, #difficultyMenu {
  width: 320px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  align-items: stretch;
}
button {
  padding: 16px 20px;
  font-size: 18px;
  border: none;
  border-radius: var(--btn-radius);
  background: var(--btn-bg);
  color: var(--btn-color);
  cursor: pointer;
  transform-origin: center;
  transition: transform 180ms ease, background-color 180ms ease, box-shadow 180ms ease;
}
button:hover, button:focus {
  transform: scale(1.06);
  background-color: #d32f2f;
  box-shadow: 0 8px 20px rgba(0,0,0,0.12);
  outline: none;
}
button:active {
  transform: scale(0.99);
}
#targetNumber {
  font-size: 32px;
  margin-top: -20px;
  margin-bottom: 15px;
}
#scoreBoard {
  position: fixed;
  top: 10px;
  right: 10px;
  background: #fff;
  padding: 12px;
  border-radius: 6px;
  box-shadow: 0 0 10px rgba(0,0,0,0.15);
  font-size: 14px;
  min-width: 120px;
  display: none;
}
#finalScoreDisplay {
  position: fixed;
  top: 50px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 28px;
  font-weight: bold;
  display: none;
}
</style>
</head>
<body>
<div id="scoreBoard"></div>
<div id="finalScoreDisplay"></div>
<div id="menu">
  <button id="gamesBtn">Oyunlar</button>
  <button id="settingsBtn">Ayarlar</button>
  <button id="creditsBtn">Credits</button>
</div>
<div id="games" style="display:none; width:320px; margin:0 auto; text-align:center;">
  <button id="startGame1">Rəqəmi Düz Tap</button>
</div>

<div id="difficultyMenu" style="display:none;">
  <button data-diff="easy">Asan</button>
  <button data-diff="medium">Orta</button>
  <button data-diff="hard">Çətin</button>
</div>

<div id="game1" style="display:none; width:320px; margin:0 auto; text-align:center; font-size:20px;">
  <div id="targetNumber"></div>
  <div id="countdown"></div>
  <div id="liveTimer" style="margin-top:20px; font-size:26px;"></div>
  <button id="stopBtn" style="margin-top:20px; display:none;">Dayandır</button>
  <button id="restartBtn" style="margin-top:10px; display:none;">Yenidən Başla</button>
  <div id="result" style="margin-top:20px; font-weight:bold;"></div>
</div>

<script>
let difficulty = "easy";
let currentInterval = null;

const menu = document.getElementById("menu");
const games = document.getElementById("games");
const difficultyMenu = document.getElementById("difficultyMenu");
const game1 = document.getElementById("game1");
const scoreBoard = document.getElementById("scoreBoard");
const finalScoreDisplay = document.getElementById("finalScoreDisplay");
const restartBtn = document.getElementById("restartBtn");

function clearGameDisplay() {
  document.getElementById("countdown").textContent = "";
  document.getElementById("liveTimer").textContent = "";
  document.getElementById("result").textContent = "";
  finalScoreDisplay.style.display = "none";
  document.getElementById("stopBtn").style.display = "none";
  restartBtn.style.display = "none";
  if (currentInterval) {
    clearInterval(currentInterval);
    currentInterval = null;
  }
}

function updateScoreHistory(newScore) {
  let list = JSON.parse(localStorage.getItem("scores") || "[]");
  list.unshift(newScore);
  list = list.slice(0, 5);
  localStorage.setItem("scores", JSON.stringify(list));
  scoreBoard.style.display = "block";
  scoreBoard.innerHTML = "Son 5 xal:<br>" + list.join("<br>");
}

function startLiveTimer(target) {
  const live = document.getElementById("liveTimer");
  const stopBtn = document.getElementById("stopBtn");
  const result = document.getElementById("result");

  stopBtn.style.display = "inline-block";
  restartBtn.style.display = "none";
  result.textContent = "";
  finalScoreDisplay.style.display = "none";
  live.textContent = "";

  let t = 0;
  let speed = difficulty === "medium" ? 0.15 : 0.1;
  // for hard mode hide after 3 seconds => 3000ms / 100ms ticks = 30 ticks
  let hideAfterTicks = difficulty === "hard" ? 30 : null;
  let ticks = 0;

  currentInterval = setInterval(() => {
    t += speed;
    ticks++;
    live.textContent = t.toFixed(1);

    if (difficulty === "hard" && ticks >= hideAfterTicks) {
      live.style.visibility = "hidden";
    }
  }, 100);

  stopBtn.onclick = () => {
    if (currentInterval) {
      clearInterval(currentInterval);
      currentInterval = null;
    }
    live.style.visibility = "visible";

    const diff = Math.abs(target - t);
    let score = 1000 - diff * 500;
    if (score < 0) score = 0;
    const finalScore = Math.round(score);

    const green = Math.min(finalScore / 1000, 1);
    const red = 1 - green;
    finalScoreDisplay.textContent = "Xal: " + finalScore;
    finalScoreDisplay.style.color = `rgb(${Math.round(red*255)},${Math.round(green*255)},0)`;
    finalScoreDisplay.style.display = "block";

    stopBtn.style.display = "none";
    restartBtn.style.display = "inline-block";
    updateScoreHistory(finalScore);
  };
}

// menu handlers
document.getElementById("gamesBtn").onclick = () => {
  clearGameDisplay();
  menu.style.display = "none";
  games.style.display = "flex";
  games.style.flexDirection = "column";
  games.style.gap = "14px";
};

// start button shows difficulty menu
document.getElementById("startGame1").onclick = () => {
  clearGameDisplay();
  games.style.display = "none";
  difficultyMenu.style.display = "flex";
  difficultyMenu.style.flexDirection = "column";
  difficultyMenu.style.gap = "14px";
};

// difficulty selection
document.querySelectorAll("#difficultyMenu button").forEach(btn => {
  btn.onclick = () => {
    difficulty = btn.dataset.diff;
    difficultyMenu.style.display = "none";
    clearGameDisplay();
    game1.style.display = "block";

    const target = +(Math.random() * (20 - 3) + 3).toFixed(1);
    document.getElementById("targetNumber").textContent = "Hədəf: " + target + " saniyə";

    let pre = 3;
    const countdown = document.getElementById("countdown");
    countdown.textContent = "Başlayır: " + pre;

    const preInt = setInterval(() => {
      pre--;
      countdown.textContent = pre > 0 ? "Başlayır: " + pre : "";
      if (pre <= 0) {
        clearInterval(preInt);
        startLiveTimer(target);
      }
    }, 1000);
  };
});

// restart returns to difficulty menu and clears displays
restartBtn.onclick = () => {
  clearGameDisplay();
  game1.style.display = "none";
  difficultyMenu.style.display = "flex";
  difficultyMenu.style.flexDirection = "column";
  difficultyMenu.style.gap = "14px";
};
</script>
</body>
</html>
